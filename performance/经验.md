# 402版本比401版本读写带宽性能低问题分析
```
402版本比401版本读写带宽性能低问题分析
问题现象：单流读写、聚合读写402版本读写带宽性能降低。
单流分析：
1、私有客户端op时延统计，发现底层时延增大明显；
2、底层同事分析发现网络时延增加明显；
3、网络同事分析发现使用的tcp协议，应该用rdma协议的；
使用rdma协议后单流分析：
问题现象：402比401低。私有客户端看底层op时延是比401低的。
私有客户端这边写缓存平均时延增加(主要是申请page、copy_from_user)
1、top看CPU使用率高（50%-60%），网络服务线程（402新加的基础库）NIO_SERV占用CPU高；
2、推测是CPU被其他线程占用，业务线程抢占CPU更难，业务线程耗CPU流程(主要是申请page、copy_from_user)平均时延增加；

经验：不是CPU占用率100%了CPU才成为瓶颈，单流测试，底层压力不大，CPU对性能会有影响。
```
